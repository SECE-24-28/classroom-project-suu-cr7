<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Recharge - Mobile Recharge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#58545F',
                        secondary: '#A97882'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-blue-100">
    <header class="bg-primary text-white shadow-lg">
        <nav class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <a href="index.html" class="flex items-center">
                    <div class="bg-white w-8 h-8 rounded-full flex items-center justify-center mr-2">
                        <span class="text-primary font-bold text-lg">M</span>
                    </div>
                    <span class="text-2xl font-bold">MobileRecharge</span>
                </a>
                <div class="space-x-4">
                    <a href="dashboard.html" class="hover:text-secondary transition">Dashboard</a>
                    <a href="plans.html" class="hover:text-secondary transition">Plans</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div class="max-w-2xl mx-auto">
            <h2 class="text-3xl font-bold text-primary text-center mb-8">Mobile Recharge</h2>
            
            <div class="bg-white rounded-lg shadow-md p-6">
                <form id="rechargeForm" class="space-y-6">
                    <div>
                        <label for="operator" class="block text-sm font-medium text-gray-700 mb-2">Select Operator</label>
                        <select id="operator" name="operator" required 
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
                            <option value="">Choose Operator</option>
                            <option value="airtel">Airtel</option>
                            <option value="jio">Jio</option>
                            <option value="vi">Vi (Vodafone Idea)</option>
                            <option value="bsnl">BSNL</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="mobile" class="block text-sm font-medium text-gray-700 mb-2">Mobile Number</label>
                        <input type="tel" id="mobile" name="mobile" required 
                               placeholder="Enter 10-digit mobile number"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
                        <span id="mobileError" class="text-red-500 text-sm hidden">Please enter a valid 10-digit mobile number</span>
                    </div>
                    
                    <div>
                        <label for="rechargeType" class="block text-sm font-medium text-gray-700 mb-2">Recharge Type</label>
                        <div class="flex space-x-4">
                            <label class="flex items-center">
                                <input type="radio" name="rechargeType" value="prepaid" checked 
                                       class="mr-2 text-primary focus:ring-primary">
                                Prepaid
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="rechargeType" value="postpaid" 
                                       class="mr-2 text-primary focus:ring-primary">
                                Postpaid
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label for="amount" class="block text-sm font-medium text-gray-700 mb-2">Amount (₹)</label>
                        <input type="number" id="amount" name="amount" min="10" max="5000" required 
                               placeholder="Enter amount"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary">
                        <span id="amountError" class="text-red-500 text-sm hidden">Amount must be between ₹10 and ₹5000</span>
                    </div>
                    
                    <div class="flex space-x-4">
                        <button type="button" onclick="browsePlans()" 
                                class="flex-1 bg-secondary text-white py-2 rounded-md hover:bg-opacity-80 transition">
                            Browse Plans
                        </button>
                        <button type="submit" 
                                class="flex-1 bg-primary text-white py-2 rounded-md hover:bg-opacity-80 transition">
                            Proceed to Pay
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Payment Summary Modal -->
            <div id="paymentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
                <div class="bg-white p-6 rounded-lg max-w-md w-full mx-4">
                    <h3 class="text-xl font-bold text-primary mb-4">Payment Summary</h3>
                    <div id="summaryContent" class="space-y-2 mb-6">
                        <!-- Summary will be populated here -->
                    </div>
                    <div class="flex space-x-4">
                        <button onclick="closeModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded">Cancel</button>
                        <button onclick="processPayment()" class="flex-1 bg-primary text-white py-2 rounded">Confirm Payment</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Get recharge type from URL if available
        const urlParams = new URLSearchParams(window.location.search);
        const rechargeType = urlParams.get('type');
        if (rechargeType) {
            document.querySelector(`input[value="${rechargeType}"]`).checked = true;
        }

        document.getElementById('rechargeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const mobile = document.getElementById('mobile').value;
            const amount = document.getElementById('amount').value;
            const operator = document.getElementById('operator').value;
            
            let isValid = true;
            
            // Mobile validation
            if (!/^\d{10}$/.test(mobile)) {
                document.getElementById('mobileError').classList.remove('hidden');
                isValid = false;
            } else {
                document.getElementById('mobileError').classList.add('hidden');
            }
            
            // Amount validation
            if (amount < 10 || amount > 5000) {
                document.getElementById('amountError').classList.remove('hidden');
                isValid = false;
            } else {
                document.getElementById('amountError').classList.add('hidden');
            }
            
            if (isValid && operator) {
                showPaymentSummary();
            }
        });

        function showPaymentSummary() {
            const mobile = document.getElementById('mobile').value;
            const amount = document.getElementById('amount').value;
            const operator = document.getElementById('operator').value;
            const type = document.querySelector('input[name="rechargeType"]:checked').value;
            
            document.getElementById('summaryContent').innerHTML = `
                <p><strong>Mobile Number:</strong> ${mobile}</p>
                <p><strong>Operator:</strong> ${operator.toUpperCase()}</p>
                <p><strong>Type:</strong> ${type.toUpperCase()}</p>
                <p><strong>Amount:</strong> ₹${amount}</p>
            `;
            
            document.getElementById('paymentModal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('paymentModal').classList.add('hidden');
        }

        function processPayment() {
            const mobile = document.getElementById('mobile').value;
            const amount = document.getElementById('amount').value;
            const operator = document.getElementById('operator').value;
            const type = document.querySelector('input[name="rechargeType"]:checked').value;
            
            // Create transaction
            const transaction = {
                id: Date.now(),
                date: new Date().toLocaleDateString(),
                amount: parseInt(amount),
                plan: `${operator.toUpperCase()} ${type} - ${mobile}`,
                type: type,
                status: 'Success'
            };
            
            // Store transaction
            let transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            transactions.unshift(transaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));
            
            alert('Payment Successful! Your recharge will be processed shortly.');
            closeModal();
            document.getElementById('rechargeForm').reset();
        }

        function browsePlans() {
            const type = document.querySelector('input[name="rechargeType"]:checked').value;
            window.location.href = `plans.html?type=${type}`;
        }
    </script>
</body>
</html>